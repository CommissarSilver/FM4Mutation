{
    "bug_id": "revelc-formatter-maven-plugin-3e9843d2ab99",
    "bug_type": "SH SF",
    "buggy_lines": "",
    "code": "    protected String doFormat(final String code, final LineEnding ending) throws IOException {\n\n        final var source = new InputSource(new StringReader(code));\n        final var parser = new CSSOMParser(new SACParserCSS3());\n        final var sheet = (CSSStyleSheetImpl) parser.parseStyleSheet(source, null, null);\n        var formattedCode = sheet.getCssText(this.formatter);\n\n        // Patch converted 'tab' back to '\\9' for IE 7,8, and 9 hack. Cssparser switches it to 'tab'.\n        formattedCode = formattedCode.replace(\"\\t;\", \"\\\\9;\");\n\n        if (code.equals(formattedCode)) {\n            return null;\n        }\n        return formattedCode;\n    }",
    "fixed_code": "    protected String doFormat(final String code, final LineEnding ending) throws IOException {\n\n        final var source = new InputSource(new StringReader(code));\n        final var parser = new CSSOMParser(new SACParserCSS3());\n        final var sheet = (CSSStyleSheetImpl) parser.parseStyleSheet(source, null, null);\n        var formattedCode = sheet.getCssText(this.formatter);\n\n        // Patch converted 'tab' back to '\\9' for IE 7,8, and 9 hack. Cssparser switches it to 'tab'.\n        formattedCode = formattedCode.replace(\"\\t;\", \"\\\\9;\");\n\n+        // Adding new line at end of file when needed\n+        String[] lines = formattedCode.split(ending.getChars());\n+        if (!lines[lines.length   1].equals(ending.getChars())) {\n+            formattedCode = formattedCode + ending.getChars();\n+        }\n+\n        if (code.equals(formattedCode)) {\n            return null;\n        }\n        return formattedCode;\n    }",
    "fixed_lines": "\n        // Adding new line at end of file when needed\n        String[] lines = formattedCode.split(ending.getChars());\n        if (!lines[lines.length - 1].equals(ending.getChars())) {\n            formattedCode = formattedCode + ending.getChars();\n        }",
    "masked_code": "    protected String doFormat(final String code, final LineEnding ending) throws IOException {\n\n        final var source = new InputSource(new StringReader(code));\n        final var parser = new CSSOMParser(new SACParserCSS3());\n        final var sheet = (CSSStyleSheetImpl) parser.parseStyleSheet(source, null, null);\n        var formattedCode = sheet.getCssText(this.formatter);\n\n        // Patch converted 'tab' back to '\\9' for IE 7,8, and 9 hack. Cssparser switches it to 'tab'.\n        formattedCode = formattedCode.replace(\"\\t;\", \"\\\\9;\");\n\n>>> [ INFILL ] <<<\n        if (code.equals(formattedCode)) {\n            return null;\n        }\n        return formattedCode;\n    }",
    "project": "revelc-formatter-maven-plugin",
    "test_error_message": "org.opentest4j.AssertionFailedError: expected: <6434062bd7499e707dea1ea17d301556712222b7671fae79ec20d906cda467a2b2210896a196dbaa9da7d221f04cab87a6b2e5538ca3c46fa7fdbedb46010a8c> but was: <1af0032669532658f137ff80186df756abcfbccbe84e9663b54ef70be2c641f5af9e8c16ceeb3da7df9dc02599a3da0c0139a9397f93e383d6e8c6c50fd65c53>",
    "test_framework": "gitbugjava",
    "test_line": "        this.twoPassTest(Collections.emptyMap(), new CssFormatter(), \"someFile.css\", expectedHash, lineEnding);",
    "test_name": "testDoFormatFile",
    "test_suite": "net.revelc.code.formatter.css.CssFormatterTest",
    "time_buggy": "2023-01-16 16:42:08 -0500",
    "time_fixed": "2023-01-26 22:50:07 -0500"
}