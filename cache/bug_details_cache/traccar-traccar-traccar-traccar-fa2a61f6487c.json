{
    "bug_id": "traccar-traccar-fa2a61f6487c",
    "bug_type": "SL SH SF",
    "buggy_lines": "",
    "code": "    private void decodeVariant(ByteBuf buf) {\n        int header = buf.getUnsignedShort(buf.readerIndex());\n        int length;\n        int type;\n        if (header == 0x7878) {\n            length = buf.getUnsignedByte(buf.readerIndex() + 2);\n            type = buf.getUnsignedByte(buf.readerIndex() + 2 + 1);\n        } else {\n            length = buf.getUnsignedShort(buf.readerIndex() + 2);\n            type = buf.getUnsignedByte(buf.readerIndex() + 2 + 2);\n        }\n\n        if (header == 0x7878 && type == MSG_GPS_LBS_1 && length == 0x24) {\n            variant = Variant.VXT01;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_STATUS_1 && length == 0x24) {\n            variant = Variant.VXT01;\n        } else if (header == 0x7878 && type == MSG_LBS_MULTIPLE_3 && length == 0x31) {\n            variant = Variant.WANWAY_S20;\n        } else if (header == 0x7878 && type == MSG_LBS_MULTIPLE_3 && length == 0x2e) {\n            variant = Variant.SR411_MINI;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_1 && length >= 0x71) {\n            variant = Variant.GT06E_CARD;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_1 && length == 0x21) {\n            variant = Variant.BENWAY;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_1 && length == 0x2b) {\n            variant = Variant.S5;\n        } else if (header == 0x7878 && type == MSG_LBS_STATUS && length >= 0x17) {\n            variant = Variant.SPACE10X;\n        } else if (header == 0x7878 && type == MSG_STATUS && length == 0x13) {\n            variant = Variant.OBD6;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_1 && length == 0x29) {\n            variant = Variant.WETRUST;\n        } else if (header == 0x7878 && type == MSG_ALARM && buf.getUnsignedShort(buf.readerIndex() + 4) == 0xffff) {\n            variant = Variant.JC400;\n        } else if (header == 0x7878 && type == MSG_LBS_3 && length == 0x37) {\n            variant = Variant.SL4X;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_2 && length == 0x2f) {\n            variant = Variant.SEEWORLD;\n        } else {\n            variant = Variant.STANDARD;\n        }\n    }",
    "fixed_code": "    private void decodeVariant(ByteBuf buf) {\n        int header = buf.getUnsignedShort(buf.readerIndex());\n        int length;\n        int type;\n        if (header == 0x7878) {\n            length = buf.getUnsignedByte(buf.readerIndex() + 2);\n            type = buf.getUnsignedByte(buf.readerIndex() + 2 + 1);\n        } else {\n            length = buf.getUnsignedShort(buf.readerIndex() + 2);\n            type = buf.getUnsignedByte(buf.readerIndex() + 2 + 2);\n        }\n\n        if (header == 0x7878 && type == MSG_GPS_LBS_1 && length == 0x24) {\n            variant = Variant.VXT01;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_STATUS_1 && length == 0x24) {\n            variant = Variant.VXT01;\n        } else if (header == 0x7878 && type == MSG_LBS_MULTIPLE_3 && length == 0x31) {\n            variant = Variant.WANWAY_S20;\n        } else if (header == 0x7878 && type == MSG_LBS_MULTIPLE_3 && length == 0x2e) {\n            variant = Variant.SR411_MINI;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_1 && length >= 0x71) {\n            variant = Variant.GT06E_CARD;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_1 && length == 0x21) {\n            variant = Variant.BENWAY;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_1 && length == 0x2b) {\n            variant = Variant.S5;\n        } else if (header == 0x7878 && type == MSG_LBS_STATUS && length >= 0x17) {\n            variant = Variant.SPACE10X;\n        } else if (header == 0x7878 && type == MSG_STATUS && length == 0x13) {\n            variant = Variant.OBD6;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_1 && length == 0x29) {\n            variant = Variant.WETRUST;\n        } else if (header == 0x7878 && type == MSG_ALARM && buf.getUnsignedShort(buf.readerIndex() + 4) == 0xffff) {\n            variant = Variant.JC400;\n        } else if (header == 0x7878 && type == MSG_LBS_3 && length == 0x37) {\n            variant = Variant.SL4X;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_2 && length == 0x2f) {\n            variant = Variant.SEEWORLD;\n+        } else if (header == 0x7878 && type == MSG_GPS_LBS_STATUS_1 && length == 0x26) {\n+            variant = Variant.SEEWORLD;\n        } else {\n            variant = Variant.STANDARD;\n        }\n    }",
    "fixed_lines": "        } else if (header == 0x7878 && type == MSG_GPS_LBS_STATUS_1 && length == 0x26) {\n            variant = Variant.SEEWORLD;",
    "masked_code": "    private void decodeVariant(ByteBuf buf) {\n        int header = buf.getUnsignedShort(buf.readerIndex());\n        int length;\n        int type;\n        if (header == 0x7878) {\n            length = buf.getUnsignedByte(buf.readerIndex() + 2);\n            type = buf.getUnsignedByte(buf.readerIndex() + 2 + 1);\n        } else {\n            length = buf.getUnsignedShort(buf.readerIndex() + 2);\n            type = buf.getUnsignedByte(buf.readerIndex() + 2 + 2);\n        }\n\n        if (header == 0x7878 && type == MSG_GPS_LBS_1 && length == 0x24) {\n            variant = Variant.VXT01;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_STATUS_1 && length == 0x24) {\n            variant = Variant.VXT01;\n        } else if (header == 0x7878 && type == MSG_LBS_MULTIPLE_3 && length == 0x31) {\n            variant = Variant.WANWAY_S20;\n        } else if (header == 0x7878 && type == MSG_LBS_MULTIPLE_3 && length == 0x2e) {\n            variant = Variant.SR411_MINI;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_1 && length >= 0x71) {\n            variant = Variant.GT06E_CARD;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_1 && length == 0x21) {\n            variant = Variant.BENWAY;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_1 && length == 0x2b) {\n            variant = Variant.S5;\n        } else if (header == 0x7878 && type == MSG_LBS_STATUS && length >= 0x17) {\n            variant = Variant.SPACE10X;\n        } else if (header == 0x7878 && type == MSG_STATUS && length == 0x13) {\n            variant = Variant.OBD6;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_1 && length == 0x29) {\n            variant = Variant.WETRUST;\n        } else if (header == 0x7878 && type == MSG_ALARM && buf.getUnsignedShort(buf.readerIndex() + 4) == 0xffff) {\n            variant = Variant.JC400;\n        } else if (header == 0x7878 && type == MSG_LBS_3 && length == 0x37) {\n            variant = Variant.SL4X;\n        } else if (header == 0x7878 && type == MSG_GPS_LBS_2 && length == 0x2f) {\n            variant = Variant.SEEWORLD;\n>>> [ INFILL ] <<<\n        } else {\n            variant = Variant.STANDARD;\n        }\n    }",
    "project": "traccar-traccar",
    "test_error_message": "    org.opentest4j.AssertionFailedError at Gt06ProtocolDecoderTest.java:20",
    "test_framework": "gitbugjava",
    "test_line": "",
    "test_name": "testDecode()",
    "test_suite": "org.traccar.protocol.Gt06ProtocolDecoderTest",
    "time_buggy": "2023-10-04 16:44:18 -0500",
    "time_fixed": "2023-10-05 16:10:18 +0800"
}